<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta name="description" />
        <meta name="keywords" content="static content generator,static site generator,static site,HTML,web development,.NET,C#,Razor,Markdown,YAML" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon">
        <link rel="icon" href="/assets/img/favicon.ico" type="image/x-icon">
        <title>Cake - VSWhere and Visual Studio 2017 Support</title>
        <link href="/assets/css/mermaid.css" rel="stylesheet">
        <link href="/assets/css/highlight.css" rel="stylesheet">
        <link href="/assets/css/bootstrap/bootstrap.css" rel="stylesheet" />
        <link href="/assets/css/adminlte/AdminLTE.css" rel="stylesheet" />
        <link href="/assets/css/theme/theme.css" rel="stylesheet" />
        <link href="//fonts.googleapis.com/css?family=Roboto+Mono:400,700|Roboto:400,400i,700,700i" rel="stylesheet">
        <link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href="/assets/css/override.css" rel="stylesheet" />
        <script src="/assets/js/jquery-2.2.3.min.js"></script>
        <script src="/assets/js/bootstrap.min.js"></script>        
        <script src="/assets/js/app.min.js"></script>         
        <script src="/assets/js/highlight.pack.js"></script>   
        <script src="/assets/js/jquery.slimscroll.min.js"></script>
        <script src="/assets/js/jquery.sticky-kit.min.js"></script>
        <script src="/assets/js/mermaid.min.js"></script>
        <!--[if lt IE 9]>
        <script src="/assets/js/html5shiv.min.js"></script>
        <script src="/assets/js/respond.min.js"></script>
        <![endif]-->  

        <script type="text/javascript" src="/assets/js/anchor.min.js"></script>
    </head>
    <body class="hold-transition wyam layout-boxed  ">    
        <div class="top-banner"></div>
        <div class="wrapper with-container">
            <!-- Header -->
            <header class="main-header">   
                     
                <a href="/" class="logo">

                                <!-- mini logo for sidebar mini 50x50 pixels -->
                                <span class="logo-mini"><img src="/assets/img/logo.png"></span>
                                <!-- logo for regular state and mobile devices -->
                                <span class="logo-lg"><img src="/assets/img/logo.png"></span>
                                            </a>   
                         
                <nav class="navbar navbar-static-top" role="navigation">
                    <!-- Sidebar toggle button-->
                        <a href="#" class="sidebar-toggle visible-xs-block" data-toggle="offcanvas" role="button">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-right"></i>
                        </a>
                                        
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                            <span class="sr-only">Toggle side menu</span>
                            <i class="fa fa-chevron-circle-down"></i>
                        </button>
                    </div>
            
                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                        <ul class="nav navbar-nav">                            
                                    <li class="active"><a href="/blog">Blog</a></li>
        <li><a href="/docs">Documentation</a></li>
        <li><a href="/dsl">Reference</a></li>
        <li><a href="/addins">Addins</a></li>
        <li><a href="/api">API</a></li>
        <li><a href="/faq">FAQ</a></li>
        <li><a href="https://github.com/cake-build/cake"><i class="fa fa-github"></i> Source</a></li>
 
                        </ul>       
                    </div>
                    <!-- /.navbar-collapse -->
                
                    <!-- Navbar Right Menu -->
                </nav>
            </header>
            
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar ">
                <section class="infobar" data-spy="affix" data-offset-top="60" data-offset-bottom="200"> 
                    	
        <div><p><a href="https://github.com/cake-build/website/blob/develop/input/blog/2017-03-27-vswhere-and-visual-studio-2017-support.md"><i class="fa fa-pencil-square" aria-hidden="true"></i> Edit Content</a></p></div>
    <div id="infobar-headings"></div>

                </section>
                <section class="sidebar">    
                                     
                    

                    <ul class="sidebar-menu">
                        

    <li class="header"><i class="fa fa-bookmark"></i> Categories</li>    
        <li><a href="/blog/Addins">Addins</a></li>
        <li><a href="/blog/Announcement">Announcement</a></li>
        <li><a href="/blog/How-Tos">How To&#x27;s</a></li>
        <li><a href="/blog/Infrastructure">Infrastructure</a></li>
        <li><a href="/blog/News">News</a></li>
        <li><a href="/blog/Release-Notes">Release Notes</a></li>
    
    <li class="header"><i class="fa fa-calendar"></i> Archive</li>    
        <li><a href="/blog/archive/2019/04">April, 2019</a></li>
        <li><a href="/blog/archive/2019/01">January, 2019</a></li>
        <li><a href="/blog/archive/2018/12">December, 2018</a></li>
        <li><a href="/blog/archive/2018/08">August, 2018</a></li>
        <li><a href="/blog/archive/2018/07">July, 2018</a></li>
        <li><a href="/blog/archive/2018/06">June, 2018</a></li>
        <li><a href="/blog/archive/2018/05">May, 2018</a></li>
        <li><a href="/blog/archive/2018/04">April, 2018</a></li>
        <li><a href="/blog/archive/2018/03">March, 2018</a></li>
        <li><a href="/blog/archive/2018/02">February, 2018</a></li>
        <li><a href="/blog/archive/2018/01">January, 2018</a></li>
        <li><a href="/blog/archive/2017/12">December, 2017</a></li>
        <li><a href="/blog/archive/2017/11">November, 2017</a></li>
        <li><a href="/blog/archive/2017/10">October, 2017</a></li>
        <li><a href="/blog/archive/2017/09">September, 2017</a></li>
        <li><a href="/blog/archive/2017/08">August, 2017</a></li>
        <li><a href="/blog/archive/2017/07">July, 2017</a></li>
        <li><a href="/blog/archive/2017/06">June, 2017</a></li>
        <li><a href="/blog/archive/2017/05">May, 2017</a></li>
        <li><a href="/blog/archive/2017/04">April, 2017</a></li>
        <li><a href="/blog/archive/2017/03">March, 2017</a></li>
        <li><a href="/blog/archive/2017/01">January, 2017</a></li>
        <li><a href="/blog/archive/2016/12">December, 2016</a></li>
        <li><a href="/blog/archive/2016/11">November, 2016</a></li>
        <li><a href="/blog/archive/2016/10">October, 2016</a></li>
        <li><a href="/blog/archive/2016/09">September, 2016</a></li>
        <li><a href="/blog/archive/2016/08">August, 2016</a></li>
        <li><a href="/blog/archive/2016/07">July, 2016</a></li>
        <li><a href="/blog/archive/2016/06">June, 2016</a></li>
        <li><a href="/blog/archive/2016/05">May, 2016</a></li>
        <li><a href="/blog/archive/2016/04">April, 2016</a></li>
        <li><a href="/blog/archive/2016/03">March, 2016</a></li>
        <li><a href="/blog/archive/2016/02">February, 2016</a></li>
        <li><a href="/blog/archive/2016/01">January, 2016</a></li>
        <li><a href="/blog/archive/2015/12">December, 2015</a></li>
        <li><a href="/blog/archive/2015/11">November, 2015</a></li>
        <li><a href="/blog/archive/2015/10">October, 2015</a></li>
        <li><a href="/blog/archive/2015/09">September, 2015</a></li>
        <li><a href="/blog/archive/2015/08">August, 2015</a></li>
        <li><a href="/blog/archive/2015/07">July, 2015</a></li>
    
    <li class="header"><i class="fa fa-user"></i> Authors</li>    
        <li><a href="/blog/author/agc93">agc93</a></li>
        <li><a href="/blog/author/daveaglick">daveaglick</a></li>
        <li><a href="/blog/author/devlead">devlead</a></li>
        <li><a href="/blog/author/gep13">gep13</a></li>
        <li><a href="/blog/author/jericho">jericho</a></li>
        <li><a href="/blog/author/Larz-White">Larz White</a></li>
        <li><a href="/blog/author/mholo65">mholo65</a></li>
        <li><a href="/blog/author/Pascal-Berger">Pascal Berger</a></li>
        <li><a href="/blog/author/patriksvensson">patriksvensson</a></li>
        <li><a href="/blog/author/phillipsj">phillipsj</a></li>
        <li><a href="/blog/author/RLittlesII">RLittlesII</a></li>

                    </ul>
                            
                </section>                
            </aside>
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                



		<section class="content-header">
			<h1>VSWhere and Visual Studio 2017 Support</h1>
		</section>
	<section class="content">
		


<dl class="dl-horizontal">
    <dt><i class="fa fa-calendar"></i> Published</dt>
    <dd>Monday, March 27, 2017</dd>
        <dt><i class="fa fa-bookmark"></i> Category</dt>
        <dd><a href="/blog/How-Tos">How To&#x27;s</a></dd>
            <dt><i class="fa fa-user"></i> Author</dt>
        <dd><a href="/blog/author/phillipsj">phillipsj</a></dd>
</dl>


<html><head></head><body><p>Since version 0.18.0 of Cake, there has been support created for Visual Studio 2017. The support was added to the MSBuild tool to search for the default installation locations of the various flavors of MSBuild. The default locations did not require an external dependency on the <a href="https://www.nuget.org/packages/Microsoft.VisualStudio.Setup.Configuration.Interop/">Microsoft.VisualStudio.Setup.Configuration.Interop</a> package that was created by Microsoft to help locate Visual Studio 2017 installations.</p>
<p>Shortly after the release of version 0.18.0, Microsoft released a tool called <a href="https://github.com/Microsoft/vswhere">vswhere</a> to help locate Visual Studio and other products in the family. This tool was released with Cake version 0.19.1 to allow everyone that moved to Visual Studio 2017 to get their builds up and running.</p>
<p>This post is going to walk through the different pieces of functionality supported by the <a href="https://cakebuild.net/dsl/vswhere/">VSWhere tool</a>.</p>
<!--excerpt-->
<h2 id="getting-started">Getting Started</h2>
<p>VSWhere is available on <a href="https://www.nuget.org/packages/vswhere/">NuGet</a> (and <a href="https://chocolatey.org/packages/vswhere">Chocolatey</a>) which means you can fetch it using the tool pre-processor directive like this:</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere
</code></pre>
<h2 id="getting-the-latest-installation">Getting the <strong>Latest</strong> installation</h2>
<p>If you just want to use the latest Visual Studio version available - then there's the <a href="https://cakebuild.net/api/Cake.Common.Tools.VSWhere/VSWhereAliases/59EB3043">VSWhereLatest</a> alias. A complete example of fetching the VSWhere tool and using it to find path to MSBuild is shown below:</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> vsLatest  = VSWhereLatest();
<a href="/api/Cake.Core.IO/FilePath">FilePath</a> msBuildPathX64 = (vsLatest==null)
                            ? null
                            : vsLatest.CombineWithFilePath("./MSBuild/15.0/Bin/amd64/MSBuild.exe");

MSBuild("./src/Example.sln", new <a href="/api/Cake.Common.Tools.MSBuild/MSBuildSettings">MSBuildSettings</a> {
    ToolPath = msBuildPathX64
});

</code></pre>
<p>If you are looking for the latest installation that supports a specific, optional component, like the .NET Framework (desktop) workload you would specify that in the <em>Requires</em> property in the settings.</p>
<p>To find a comprehensive list of components, please see the Microsoft Documentation <a href="https://docs.microsoft.com/en-us/visualstudio/install/workload-and-component-ids">here</a></p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> vsLatest  = VSWhereLatest(new <a href="/api/Cake.Common.Tools.VSWhere.Latest/VSWhereLatestSettings">VSWhereLatestSettings</a> { Requires = "Microsoft.VisualStudio.Workload.ManagedDesktop"});
<a href="/api/Cake.Core.IO/FilePath">FilePath</a> msBuildPathX64 = (vsLatest==null)
                            ? null
                            : vsLatest.CombineWithFilePath("./MSBuild/15.0/Bin/amd64/MSBuild.exe");

MSBuild("./src/Example.sln", new <a href="/api/Cake.Common.Tools.MSBuild/MSBuildSettings">MSBuildSettings</a> {
    ToolPath = msBuildPathX64
});

</code></pre>
<h2 id="finding-all-visual-studio-installations">Finding all Visual Studio installations</h2>
<p>If you would like to find all Visual Studio installations regardless if they are complete installations you would run the following.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPathCollection">DirectoryPathCollection</a> allInstalled  = VSWhereAll();

foreach(var install in allInstalled)
{
    // Find the installation you need
}
</code></pre>
<p>Of course you can find all restricted to the type of components or workloads installed by using the settings and setting the required component. In this instance it restricts it to only installations that have MSBuild installed.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPathCollection">DirectoryPathCollection</a> allInstalled  = VSWhereAll(new <a href="/api/Cake.Common.Tools.VSWhere.All/VSWhereAllSettings">VSWhereAllSettings</a> { Requires = "Microsoft.Component.MSBuild" });

foreach(var install in allInstalled)
{
    // Find the installation you need
}
</code></pre>
<h2 id="finding-a-specific-product-including-vstest">Finding a specific product, including VSTest</h2>
<p>If you know you would like to find the directory for a specific product you can do the following.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> buildToolsInstallation  = VSWhereProducts("Microsoft.VisualStudio.Product.BuildTools").FirstOrDefault();

if(buildToolsInstallation != null)
{
    MSBuild("./src/Example.sln", new <a href="/api/Cake.Common.Tools.MSBuild/MSBuildSettings">MSBuildSettings</a> {
        ToolPath = buildToolsInstallation.CombineWithFilePath("./MSBuild/15.0/Bin/amd64/MSBuild.exe")
    });
}

</code></pre>
<p>If you know you need the build tools installation with a specific component or workload installed then you can search for it.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> buildToolsInstallation  = VSWhereProducts("Microsoft.VisualStudio.Product.BuildTools",
                                            new <a href="/api/Cake.Common.Tools.VSWhere.Latest/VSWhereLatestSettings">VSWhereLatestSettings</a> { Requires = "Microsoft.VisualStudio.Workload.ManagedDesktop"}).FirstOrDefault();

if(buildToolsInstallation != null)
{
    MSBuild("./src/Example.sln", new <a href="/api/Cake.Common.Tools.MSBuild/MSBuildSettings">MSBuildSettings</a> {
        ToolPath = buildToolsInstallation.CombineWithFilePath("./MSBuild/15.0/Bin/amd64/MSBuild.exe")
    });
}
else
{
    Information("Could not find suitable build environment.");
}

</code></pre>
<p>You can also find VSTest using VSWhere.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> vsTestInstallationPath  = VSWhereProducts("*", new <a href="/api/Cake.Common.Tools.VSWhere.Latest/VSWhereLatestSettings">VSWhereLatestSettings</a> { Requires = "Microsoft.VisualStudio.PackageGroup.TestTools.Core"}).FirstOrDefault();

<a href="/api/Cake.Core.IO/FilePath">FilePath</a> vsTestPath = (vsTestInstallationPath==null)
                            ? null
                            : vsTestInstallationPath.CombineWithFilePath("./Common7/IDE/CommonExtensions/Microsoft/TestWindow/vstest.console.exe");

VSTest("./Tests/*.UnitTests.dll", new VSTestSettings() {
                                            Logger = VSTestLogger.Trx,
                                            ToolPath = vsTestPath });
</code></pre>
<h2 id="finding-legacy-products">Finding legacy products</h2>
<p>VSWhere also has support for finding legacy products.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> legacyInstallationPath = VSWhereLegacy(true);  // Passing true gets the latest version.

</code></pre>
<p>If you know you are looking for a specific version of a legacy product then you can do the following.</p>
<pre><code class="language-csharp">#tool nuget:?package=vswhere

<a href="/api/Cake.Core.IO/DirectoryPath">DirectoryPath</a> legacyInstallationPath = VSWhereLegacy(new <a href="/api/Cake.Common.Tools.VSWhere.Legacy/VSWhereLegacySettings">VSWhereLegacySettings</a> { Version = "10.0"}).FirstOrDefault();

</code></pre>
</body></html>

<hr />

<ul class="share-buttons">
  <li><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support&t=VSWhere%20and%20Visual%20Studio%202017%20Support" title="Share on Facebook" target="_blank"><img alt="Share on Facebook" src="/assets/img/social_flat_rounded_rects_svg/Facebook.svg"></a></li>
  <li><a href="https://twitter.com/intent/tweet?source=http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support&text=VSWhere%20and%20Visual%20Studio%202017%20Support:%20http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support&via=cakebuildnet" target="_blank" title="Tweet"><img alt="Tweet" src="/assets/img/social_flat_rounded_rects_svg/Twitter.svg"></a></li>
  <li><a href="http://www.reddit.com/submit?url=http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support&title=VSWhere%20and%20Visual%20Studio%202017%20Support" target="_blank" title="Submit to Reddit"><img alt="Submit to Reddit" src="/assets/img/social_flat_rounded_rects_svg/Reddit.svg"></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support&title=VSWhere%20and%20Visual%20Studio%202017%20Support&summary=&source=http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support" target="_blank" title="Share on LinkedIn"><img alt="Share on LinkedIn" src="/assets/img/social_flat_rounded_rects_svg/LinkedIn.svg"></a></li>
  <li><a href="mailto:?subject=VSWhere%20and%20Visual%20Studio%202017%20Support&body=:%20http%3A%2F%2Fcakebuild.net%2Fblog%2F2017%2F03%2Fvswhere-and-visual-studio-2017-support" target="_blank" title="Send email"><img alt="Send email" src="/assets/img/social_flat_rounded_rects_svg/Email.svg"></a></li>
</ul>

	</section>
                
            </div>           
            
            <!-- Footer -->
            <footer class="main-footer">
            </footer>
            
        </div>
        <div class="wrapper bottom-wrapper">
            <footer class="bottom-footer">
                <p class="text-muted">
    <a href="https://github.com/cake-build/cake"><i class="fa fa-github"></i> GitHub</a> |
    <a href="https://twitter.com/cakebuildnet"><i class="fa fa-twitter"></i> Twitter</a> |
    <a href="https://gitter.im/cake-build/cake"><i class="fa fa-comment"></i> Gitter</a>
    <br/>
    Copyright &copy; <a href="http://dotnetfoundation.org">.NET Foundation</a> and contributors.
    <br/>
    Generated by <a href="http://wyam.io">Wyam</a>
</p>

<script>
    anchors.add();
</script>
            </footer>
        </div>
        <a href="javascript:" id="return-to-top"><i class="fa fa-chevron-up"></i></a>
        <!-- Gitter -->
<script>
    ((window.gitter = {}).chat = {}).options = {
        room: 'cake-build/cake'
    };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-60516413-1', 'auto');
    ga('send', 'pageview');
</script>
        <script>           
            // Close the sidebar if we select an anchor link
            $(".main-sidebar a[href^='#']:not('.expand')").click(function(){
                $(document.body).removeClass('sidebar-open');
            });
            
            $(document).load(function() {
                mermaid.initialize(
                {
                    flowchart:
                    {
                        htmlLabels: false,
                        useMaxWidth:false
                    }
                });  
                mermaid.init(undefined, ".mermaid")
                $('svg').addClass('img-responsive');
                
                $('pre code').each(function(i, block) {
                    hljs.highlightBlock(block);
                });  
            });
            hljs.initHighlightingOnLoad();

            // Back to top
            $(window).scroll(function() {
                if ($(this).scrollTop() >= 200) {        // If page is scrolled more than 50px
                    $('#return-to-top').fadeIn(1000);    // Fade in the arrow
                } else {
                    $('#return-to-top').fadeOut(1000);   // Else fade out the arrow
                }
            });
            $('#return-to-top').click(function() {      // When arrow is clicked
                $('body,html').animate({
                    scrollTop : 0                       // Scroll to top of body
                }, 500);
            });
        </script>
    </body>
</html>